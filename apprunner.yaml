version: 1.0
runtime: python311 # Specifies the Python 3.11 runtime environment.
build:
  # Commands to execute during the build phase.
  # Using a block scalar style for commands to ensure correct parsing.
  commands: |
    python3.11 -m pip install --upgrade pip
    python3.11 -m pip install -r requirements.txt
run:
  # The command to start your application server.
  # Gunicorn is used here as a production-ready WSGI server for Flask applications.
  # We explicitly set PYTHONPATH to '.' (the current directory, which is /app/backend)
  # to ensure Python can find installed packages relative to the application code.
  # Using 'python3.11 -m gunicorn' to ensure the correct Gunicorn executable is found.
  command: PYTHONPATH=. python3.11 -m gunicorn --bind :8080 app:app
  # Network configuration for your application.
  network:
    # App Runner typically exposes applications on port 8080.
    # Your run.py uses os.environ.get("PORT", 5000), so if App Runner sets PORT=8080, it will use that.
    port: 8080
# Specifies the subdirectory within your Git repository where your application source code resides.
# App Runner will set its working directory to this path during build and run.
source_directory: backend